(project) C:\Users\yimen\Desktop\comp_551\A4\NER>python main.py
Loading Data...
Done
Training with CRF Model...
##################################################################
##################################################################
Done Training, total time: 37s.
Evaluating CRF Model ...
           precision    recall  f1-score   support
    B-LOC     1.0000    0.8333    0.9091         6
   B-CONT     1.0000    1.0000    1.0000        28
   E-NAME     1.0000    0.9821    0.9910       112
    M-PRO     0.8354    0.9706    0.8980        68
   B-NAME     1.0000    0.9821    0.9910       112
  E-TITLE     0.9857    0.9818    0.9838       771
   E-CONT     1.0000    1.0000    1.0000        28
    E-LOC     1.0000    0.8333    0.9091         6
 E-TITLE
     1.0000    1.0000    1.0000         1
    B-ORG     0.9531    0.9548    0.9539       553
        O     0.9589    0.9697    0.9642      4714
   B-RACE     1.0000    1.0000    1.0000        14
    M-ORG     0.9451    0.9586    0.9518      4325
  M-TITLE     0.9446    0.8959    0.9196      1922
    E-ORG     0.9116    0.9132    0.9124       553
   M-CONT     1.0000    1.0000    1.0000        53
    M-EDU     0.9824    0.9330    0.9570       179
    E-EDU     0.9910    0.9821    0.9865       112
   M-NAME     1.0000    0.9756    0.9877        82
       O
     1.0000    1.0000    1.0000       476
    E-PRO     0.9091    0.9091    0.9091        33
  B-TITLE     0.9389    0.9352    0.9371       772
   E-RACE     1.0000    1.0000    1.0000        14
    M-LOC     1.0000    0.8095    0.8947        21
    B-PRO     0.9091    0.9091    0.9091        33
    B-EDU     0.9820    0.9732    0.9776       112
avg/total     0.9540    0.9539    0.9538     15100
##################################################################
Confusion Matrix:
          B-LOC  B-CONT  E-NAME   M-PRO  B-NAME E-TITLE  E-CONT   E-LOC E-TITLE
   B-ORG       O  B-RACE   M-ORG M-TITLE   E-ORG  M-CONT   M-EDU   E-EDU  M-NAME      O
   E-PRO B-TITLE  E-RACE   M-LOC   B-PRO   B-EDU
  B-LOC       5       0       0       0       0       0       0       0       0       1       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0
 B-CONT       0      28       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0
 E-NAME       0       0     110       0       0       0       0       0       0       0       2       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0
  M-PRO       0       0       0      66       0       0       0       0       0       0       0       0       2       0       0       0       0       0       0       0       0       0       0       0       0       0
 B-NAME       0       0       0       0     110       0       0       0       0       0       2       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0
E-TITLE       0       0       0       0       0     757       0       0       0       0       9       0       2       0       1       0       0       1       0       0       0       1       0       0       0       0
 E-CONT       0       0       0       0       0       0      28       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0
  E-LOC       0       0       0       0       0       0       0       5       0       0       0       0       0       0       1       0       0       0       0       0       0       0       0       0       0       0
E-TITLE
       0       0       0       0       0       0       0       0       1       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0
  B-ORG       0       0       0       0       0       0       0       0       0     528      12       0       1       0       0       0       0       0       0       0       0      12       0       0       0       0
      O       0       0       0       0       0       4       0       0       0      12    4571       0     100       8      14       0       0       0       0       0       0       5       0       0       0       0
 B-RACE       0       0       0       0       0       0       0       0       0       0       0      14       0       0       0       0       0       0       0       0       0       0       0       0       0       0
  M-ORG       0       0       0       5       0       2       0       0       0       2      93       0    4146      55      11       0       0       0       0       0       1       9       0       0       1       0
M-TITLE       0       0       0       2       0       4       0       0       0       2      53       0      96    1722      20       0       1       0       0       0       1      20       0       0       0       1
  E-ORG       0       0       0       0       0       1       0       0       0       0      14       0      15      18     505       0       0       0       0       0       0       0       0       0       0       0
 M-CONT       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0      53       0       0       0       0       0       0       0       0       0       0
  M-EDU       0       0       0       4       0       0       0       0       0       0       1       0       5       0       1       0     167       0       0       0       0       0       0       0       1       0
  E-EDU       0       0       0       0       0       0       0       0       0       0       0       0       1       0       0       0       0     110       0       0       1       0       0       0       0       0
 M-NAME       0       0       0       0       0       0       0       0       0       0       2       0       0       0       0       0       0       0      80       0       0       0       0       0       0       0
     O
       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0     476       0       0       0       0       0       0
  E-PRO       0       0       0       1       0       0       0       0       0       0       0       0       0       0       1       0       1       0       0       0      30       0       0       0       0       0
B-TITLE       0       0       0       0       0       0       0       0       0       8       8       0      13      20       0       0       0       0       0       0       0     722       0       0       1       0
 E-RACE       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0      14       0       0       0
  M-LOC       0       0       0       0       0       0       0       0       0       0       0       0       4       0       0       0       0       0       0       0       0       0       0      17       0       0
  B-PRO       0       0       0       1       0       0       0       0       0       0       0       0       1       0       0       0       0       0       0       0       0       0       0       0      30       1
  B-EDU       0       0       0       0       0       0       0       0       0       1       0       0       1       0       0       0       1       0       0       0       0       0       0       0       0     109
Training with BiLSTM-CRF Model...
##################################################################
It is training on Cuda
##################################################################
Epoch: 1, step/total_step: 5/60 8.33%   | Loss:334.8176
Epoch: 1, step/total_step: 10/60 16.67%         | Loss:179.9540
Epoch: 1, step/total_step: 15/60 25.00%         | Loss:110.4641
Epoch: 1, step/total_step: 20/60 33.33%         | Loss:62.1503
Epoch: 1, step/total_step: 25/60 41.67%         | Loss:46.6875
Epoch: 1, step/total_step: 30/60 50.00%         | Loss:36.5392
Epoch: 1, step/total_step: 35/60 58.33%         | Loss:30.0657
Epoch: 1, step/total_step: 40/60 66.67%         | Loss:26.1928
Epoch: 1, step/total_step: 45/60 75.00%         | Loss:22.5876
Epoch: 1, step/total_step: 50/60 83.33%         | Loss:17.7929
Epoch: 1, step/total_step: 55/60 91.67%         | Loss:16.4885
Epoch: 1, step/total_step: 60/60 100.00%        | Loss:11.6515
Saving the best model.....
Epoch: 1                                |  Val Loss:28.1548
##################################################################
Epoch: 2, step/total_step: 5/60 8.33%   | Loss:105.9091
Epoch: 2, step/total_step: 10/60 16.67%         | Loss:54.6934
Epoch: 2, step/total_step: 15/60 25.00%         | Loss:34.0712
Epoch: 2, step/total_step: 20/60 33.33%         | Loss:23.7587
Epoch: 2, step/total_step: 25/60 41.67%         | Loss:20.1340
Epoch: 2, step/total_step: 30/60 50.00%         | Loss:16.7162
Epoch: 2, step/total_step: 35/60 58.33%         | Loss:14.4002
Epoch: 2, step/total_step: 40/60 66.67%         | Loss:13.0570
Epoch: 2, step/total_step: 45/60 75.00%         | Loss:11.4680
Epoch: 2, step/total_step: 50/60 83.33%         | Loss:9.6516
Epoch: 2, step/total_step: 55/60 91.67%         | Loss:9.5951
Epoch: 2, step/total_step: 60/60 100.00%        | Loss:7.0503
Saving the best model.....
Epoch: 2                                |  Val Loss:14.8789
##################################################################
Epoch: 3, step/total_step: 5/60 8.33%   | Loss:52.1910
Epoch: 3, step/total_step: 10/60 16.67%         | Loss:30.4964
Epoch: 3, step/total_step: 15/60 25.00%         | Loss:18.9405
Epoch: 3, step/total_step: 20/60 33.33%         | Loss:13.0524
Epoch: 3, step/total_step: 25/60 41.67%         | Loss:11.3573
Epoch: 3, step/total_step: 30/60 50.00%         | Loss:9.3026
Epoch: 3, step/total_step: 35/60 58.33%         | Loss:8.2129
Epoch: 3, step/total_step: 40/60 66.67%         | Loss:7.5841
Epoch: 3, step/total_step: 45/60 75.00%         | Loss:6.7798
Epoch: 3, step/total_step: 50/60 83.33%         | Loss:5.7931
Epoch: 3, step/total_step: 55/60 91.67%         | Loss:5.5373
Epoch: 3, step/total_step: 60/60 100.00%        | Loss:4.0370
Saving the best model.....
Epoch: 3                                |  Val Loss:9.5304
##################################################################
Epoch: 4, step/total_step: 5/60 8.33%   | Loss:33.0818
Epoch: 4, step/total_step: 10/60 16.67%         | Loss:19.4613
Epoch: 4, step/total_step: 15/60 25.00%         | Loss:12.1436
Epoch: 4, step/total_step: 20/60 33.33%         | Loss:8.1168
Epoch: 4, step/total_step: 25/60 41.67%         | Loss:7.5408
Epoch: 4, step/total_step: 30/60 50.00%         | Loss:6.1219
Epoch: 4, step/total_step: 35/60 58.33%         | Loss:5.6680
Epoch: 4, step/total_step: 40/60 66.67%         | Loss:5.2074
Epoch: 4, step/total_step: 45/60 75.00%         | Loss:4.6846
Epoch: 4, step/total_step: 50/60 83.33%         | Loss:3.9115
Epoch: 4, step/total_step: 55/60 91.67%         | Loss:3.5746
Epoch: 4, step/total_step: 60/60 100.00%        | Loss:2.7540
Saving the best model.....
Epoch: 4                                |  Val Loss:7.1205
##################################################################
Epoch: 5, step/total_step: 5/60 8.33%   | Loss:23.4684
Epoch: 5, step/total_step: 10/60 16.67%         | Loss:13.8860
Epoch: 5, step/total_step: 15/60 25.00%         | Loss:8.7709
Epoch: 5, step/total_step: 20/60 33.33%         | Loss:5.7754
Epoch: 5, step/total_step: 25/60 41.67%         | Loss:5.6569
Epoch: 5, step/total_step: 30/60 50.00%         | Loss:4.4007
Epoch: 5, step/total_step: 35/60 58.33%         | Loss:4.2703
Epoch: 5, step/total_step: 40/60 66.67%         | Loss:3.9186
Epoch: 5, step/total_step: 45/60 75.00%         | Loss:3.5091
Epoch: 5, step/total_step: 50/60 83.33%         | Loss:2.8969
Epoch: 5, step/total_step: 55/60 91.67%         | Loss:2.5853
Epoch: 5, step/total_step: 60/60 100.00%        | Loss:2.0493
Saving the best model.....
Epoch: 5                                |  Val Loss:5.9804
##################################################################
Epoch: 6, step/total_step: 5/60 8.33%   | Loss:18.1336
Epoch: 6, step/total_step: 10/60 16.67%         | Loss:10.6682
Epoch: 6, step/total_step: 15/60 25.00%         | Loss:6.9947
Epoch: 6, step/total_step: 20/60 33.33%         | Loss:4.4738
Epoch: 6, step/total_step: 25/60 41.67%         | Loss:4.3564
Epoch: 6, step/total_step: 30/60 50.00%         | Loss:3.3742
Epoch: 6, step/total_step: 35/60 58.33%         | Loss:3.3840
Epoch: 6, step/total_step: 40/60 66.67%         | Loss:3.0915
Epoch: 6, step/total_step: 45/60 75.00%         | Loss:2.7603
Epoch: 6, step/total_step: 50/60 83.33%         | Loss:2.2573
Epoch: 6, step/total_step: 55/60 91.67%         | Loss:2.0015
Epoch: 6, step/total_step: 60/60 100.00%        | Loss:1.5782
Saving the best model.....
Epoch: 6                                |  Val Loss:5.2781
##################################################################
Epoch: 7, step/total_step: 5/60 8.33%   | Loss:14.5802
Epoch: 7, step/total_step: 10/60 16.67%         | Loss:8.5767
Epoch: 7, step/total_step: 15/60 25.00%         | Loss:5.8026
Epoch: 7, step/total_step: 20/60 33.33%         | Loss:3.6391
Epoch: 7, step/total_step: 25/60 41.67%         | Loss:3.4548
Epoch: 7, step/total_step: 30/60 50.00%         | Loss:2.6856
Epoch: 7, step/total_step: 35/60 58.33%         | Loss:2.7765
Epoch: 7, step/total_step: 40/60 66.67%         | Loss:2.5106
Epoch: 7, step/total_step: 45/60 75.00%         | Loss:2.2514
Epoch: 7, step/total_step: 50/60 83.33%         | Loss:1.8287
Epoch: 7, step/total_step: 55/60 91.67%         | Loss:1.5934
Epoch: 7, step/total_step: 60/60 100.00%        | Loss:1.2402
Saving the best model.....
Epoch: 7                                |  Val Loss:4.7509
##################################################################
Epoch: 8, step/total_step: 5/60 8.33%   | Loss:11.7421
Epoch: 8, step/total_step: 10/60 16.67%         | Loss:6.9076
Epoch: 8, step/total_step: 15/60 25.00%         | Loss:4.9102
Epoch: 8, step/total_step: 20/60 33.33%         | Loss:2.8320
Epoch: 8, step/total_step: 25/60 41.67%         | Loss:2.7860
Epoch: 8, step/total_step: 30/60 50.00%         | Loss:2.1787
Epoch: 8, step/total_step: 35/60 58.33%         | Loss:2.3803
Epoch: 8, step/total_step: 40/60 66.67%         | Loss:2.1194
Epoch: 8, step/total_step: 45/60 75.00%         | Loss:1.8099
Epoch: 8, step/total_step: 50/60 83.33%         | Loss:1.5439
Epoch: 8, step/total_step: 55/60 91.67%         | Loss:1.2972
Epoch: 8, step/total_step: 60/60 100.00%        | Loss:0.9909
Saving the best model.....
Epoch: 8                                |  Val Loss:4.2602
##################################################################
Epoch: 9, step/total_step: 5/60 8.33%   | Loss:9.7947
Epoch: 9, step/total_step: 10/60 16.67%         | Loss:5.6712
Epoch: 9, step/total_step: 15/60 25.00%         | Loss:4.2622
Epoch: 9, step/total_step: 20/60 33.33%         | Loss:2.3299
Epoch: 9, step/total_step: 25/60 41.67%         | Loss:2.3655
Epoch: 9, step/total_step: 30/60 50.00%         | Loss:1.9116
Epoch: 9, step/total_step: 35/60 58.33%         | Loss:1.9655
Epoch: 9, step/total_step: 40/60 66.67%         | Loss:1.8376
Epoch: 9, step/total_step: 45/60 75.00%         | Loss:1.4680
Epoch: 9, step/total_step: 50/60 83.33%         | Loss:1.3045
Epoch: 9, step/total_step: 55/60 91.67%         | Loss:1.0769
Epoch: 9, step/total_step: 60/60 100.00%        | Loss:0.8123
Saving the best model.....
Epoch: 9                                |  Val Loss:4.0125
##################################################################
Epoch: 10, step/total_step: 5/60 8.33%  | Loss:8.4654
Epoch: 10, step/total_step: 10/60 16.67%        | Loss:4.8985
Epoch: 10, step/total_step: 15/60 25.00%        | Loss:3.9758
Epoch: 10, step/total_step: 20/60 33.33%        | Loss:2.2372
Epoch: 10, step/total_step: 25/60 41.67%        | Loss:2.2269
Epoch: 10, step/total_step: 30/60 50.00%        | Loss:1.7584
Epoch: 10, step/total_step: 35/60 58.33%        | Loss:1.8150
Epoch: 10, step/total_step: 40/60 66.67%        | Loss:1.6098
Epoch: 10, step/total_step: 45/60 75.00%        | Loss:1.2939
Epoch: 10, step/total_step: 50/60 83.33%        | Loss:1.1714
Epoch: 10, step/total_step: 55/60 91.67%        | Loss:0.9297
Epoch: 10, step/total_step: 60/60 100.00%       | Loss:0.6883
Saving the best model.....
Epoch: 10                               |  Val Loss:3.9549
##################################################################
Epoch: 11, step/total_step: 5/60 8.33%  | Loss:6.8509
Epoch: 11, step/total_step: 10/60 16.67%        | Loss:4.0632
Epoch: 11, step/total_step: 15/60 25.00%        | Loss:3.3309
Epoch: 11, step/total_step: 20/60 33.33%        | Loss:1.8298
Epoch: 11, step/total_step: 25/60 41.67%        | Loss:1.9131
Epoch: 11, step/total_step: 30/60 50.00%        | Loss:1.4853
Epoch: 11, step/total_step: 35/60 58.33%        | Loss:1.5228
Epoch: 11, step/total_step: 40/60 66.67%        | Loss:1.2659
Epoch: 11, step/total_step: 45/60 75.00%        | Loss:1.2037
Epoch: 11, step/total_step: 50/60 83.33%        | Loss:0.9813
Epoch: 11, step/total_step: 55/60 91.67%        | Loss:0.7859
Epoch: 11, step/total_step: 60/60 100.00%       | Loss:0.5743
Saving the best model.....
Epoch: 11                               |  Val Loss:3.8404
##################################################################
Epoch: 12, step/total_step: 5/60 8.33%  | Loss:5.8734
Epoch: 12, step/total_step: 10/60 16.67%        | Loss:3.4171
Epoch: 12, step/total_step: 15/60 25.00%        | Loss:2.6695
Epoch: 12, step/total_step: 20/60 33.33%        | Loss:1.5624
Epoch: 12, step/total_step: 25/60 41.67%        | Loss:1.6078
Epoch: 12, step/total_step: 30/60 50.00%        | Loss:1.1545
Epoch: 12, step/total_step: 35/60 58.33%        | Loss:1.3759
Epoch: 12, step/total_step: 40/60 66.67%        | Loss:1.1450
Epoch: 12, step/total_step: 45/60 75.00%        | Loss:0.9409
Epoch: 12, step/total_step: 50/60 83.33%        | Loss:0.8430
Epoch: 12, step/total_step: 55/60 91.67%        | Loss:0.6742
Epoch: 12, step/total_step: 60/60 100.00%       | Loss:0.4928
Saving the best model.....
Epoch: 12                               |  Val Loss:3.7771
##################################################################
Epoch: 13, step/total_step: 5/60 8.33%  | Loss:5.0427
Epoch: 13, step/total_step: 10/60 16.67%        | Loss:2.9560
Epoch: 13, step/total_step: 15/60 25.00%        | Loss:2.4135
Epoch: 13, step/total_step: 20/60 33.33%        | Loss:1.2620
Epoch: 13, step/total_step: 25/60 41.67%        | Loss:1.3482
Epoch: 13, step/total_step: 30/60 50.00%        | Loss:0.9862
Epoch: 13, step/total_step: 35/60 58.33%        | Loss:1.1707
Epoch: 13, step/total_step: 40/60 66.67%        | Loss:0.9789
Epoch: 13, step/total_step: 45/60 75.00%        | Loss:0.7845
Epoch: 13, step/total_step: 50/60 83.33%        | Loss:0.7198
Epoch: 13, step/total_step: 55/60 91.67%        | Loss:0.5786
Epoch: 13, step/total_step: 60/60 100.00%       | Loss:0.4288
Saving the best model.....
Epoch: 13                               |  Val Loss:3.7566
##################################################################
Epoch: 14, step/total_step: 5/60 8.33%  | Loss:4.2130
Epoch: 14, step/total_step: 10/60 16.67%        | Loss:2.8981
Epoch: 14, step/total_step: 15/60 25.00%        | Loss:2.1540
Epoch: 14, step/total_step: 20/60 33.33%        | Loss:1.3705
Epoch: 14, step/total_step: 25/60 41.67%        | Loss:1.2972
Epoch: 14, step/total_step: 30/60 50.00%        | Loss:0.9166
Epoch: 14, step/total_step: 35/60 58.33%        | Loss:1.0884
Epoch: 14, step/total_step: 40/60 66.67%        | Loss:0.8954
Epoch: 14, step/total_step: 45/60 75.00%        | Loss:0.6964
Epoch: 14, step/total_step: 50/60 83.33%        | Loss:0.6466
Epoch: 14, step/total_step: 55/60 91.67%        | Loss:0.5222
Epoch: 14, step/total_step: 60/60 100.00%       | Loss:0.3758
Epoch: 14                               |  Val Loss:3.8382
##################################################################
Epoch: 15, step/total_step: 5/60 8.33%  | Loss:3.7233
Epoch: 15, step/total_step: 10/60 16.67%        | Loss:2.4303
Epoch: 15, step/total_step: 15/60 25.00%        | Loss:2.3693
Epoch: 15, step/total_step: 20/60 33.33%        | Loss:1.2138
Epoch: 15, step/total_step: 25/60 41.67%        | Loss:1.5368
Epoch: 15, step/total_step: 30/60 50.00%        | Loss:0.8445
Epoch: 15, step/total_step: 35/60 58.33%        | Loss:1.0166
Epoch: 15, step/total_step: 40/60 66.67%        | Loss:0.9521
Epoch: 15, step/total_step: 45/60 75.00%        | Loss:0.7008
Epoch: 15, step/total_step: 50/60 83.33%        | Loss:0.5812
Epoch: 15, step/total_step: 55/60 91.67%        | Loss:0.4683
Epoch: 15, step/total_step: 60/60 100.00%       | Loss:0.3315
Epoch: 15                               |  Val Loss:3.8566
##################################################################
Epoch: 16, step/total_step: 5/60 8.33%  | Loss:3.5285
Epoch: 16, step/total_step: 10/60 16.67%        | Loss:1.9513
Epoch: 16, step/total_step: 15/60 25.00%        | Loss:2.2777
Epoch: 16, step/total_step: 20/60 33.33%        | Loss:0.8842
Epoch: 16, step/total_step: 25/60 41.67%        | Loss:1.1991
Epoch: 16, step/total_step: 30/60 50.00%        | Loss:1.0237
Epoch: 16, step/total_step: 35/60 58.33%        | Loss:0.9093
Epoch: 16, step/total_step: 40/60 66.67%        | Loss:0.6725
Epoch: 16, step/total_step: 45/60 75.00%        | Loss:0.6273
Epoch: 16, step/total_step: 50/60 83.33%        | Loss:0.5549
Epoch: 16, step/total_step: 55/60 91.67%        | Loss:0.4231
Epoch: 16, step/total_step: 60/60 100.00%       | Loss:0.2912
Epoch: 16                               |  Val Loss:3.9950
##################################################################
Epoch: 17, step/total_step: 5/60 8.33%  | Loss:3.3388
Epoch: 17, step/total_step: 10/60 16.67%        | Loss:2.1737
Epoch: 17, step/total_step: 15/60 25.00%        | Loss:1.6822
Epoch: 17, step/total_step: 20/60 33.33%        | Loss:1.1655
Epoch: 17, step/total_step: 25/60 41.67%        | Loss:0.9290
Epoch: 17, step/total_step: 30/60 50.00%        | Loss:0.6628
Epoch: 17, step/total_step: 35/60 58.33%        | Loss:0.9034
Epoch: 17, step/total_step: 40/60 66.67%        | Loss:0.6392
Epoch: 17, step/total_step: 45/60 75.00%        | Loss:0.5075
Epoch: 17, step/total_step: 50/60 83.33%        | Loss:0.4571
Epoch: 17, step/total_step: 55/60 91.67%        | Loss:0.3805
Epoch: 17, step/total_step: 60/60 100.00%       | Loss:0.2590
Epoch: 17                               |  Val Loss:4.1013
##################################################################
Epoch: 18, step/total_step: 5/60 8.33%  | Loss:2.6914
Epoch: 18, step/total_step: 10/60 16.67%        | Loss:1.5534
Epoch: 18, step/total_step: 15/60 25.00%        | Loss:1.3485
Epoch: 18, step/total_step: 20/60 33.33%        | Loss:0.7059
Epoch: 18, step/total_step: 25/60 41.67%        | Loss:0.7726
Epoch: 18, step/total_step: 30/60 50.00%        | Loss:0.5433
Epoch: 18, step/total_step: 35/60 58.33%        | Loss:0.6565
Epoch: 18, step/total_step: 40/60 66.67%        | Loss:0.4994
Epoch: 18, step/total_step: 45/60 75.00%        | Loss:0.4356
Epoch: 18, step/total_step: 50/60 83.33%        | Loss:0.3841
Epoch: 18, step/total_step: 55/60 91.67%        | Loss:0.3292
Epoch: 18, step/total_step: 60/60 100.00%       | Loss:0.2280
Saving the best model.....
Epoch: 18                               |  Val Loss:3.7085
##################################################################
Epoch: 19, step/total_step: 5/60 8.33%  | Loss:2.0281
Epoch: 19, step/total_step: 10/60 16.67%        | Loss:1.1292
Epoch: 19, step/total_step: 15/60 25.00%        | Loss:1.1110
Epoch: 19, step/total_step: 20/60 33.33%        | Loss:0.5406
Epoch: 19, step/total_step: 25/60 41.67%        | Loss:0.5813
Epoch: 19, step/total_step: 30/60 50.00%        | Loss:0.4202
Epoch: 19, step/total_step: 35/60 58.33%        | Loss:0.5770
Epoch: 19, step/total_step: 40/60 66.67%        | Loss:0.4094
Epoch: 19, step/total_step: 45/60 75.00%        | Loss:0.3690
Epoch: 19, step/total_step: 50/60 83.33%        | Loss:0.3363
Epoch: 19, step/total_step: 55/60 91.67%        | Loss:0.2951
Epoch: 19, step/total_step: 60/60 100.00%       | Loss:0.2016
Saving the best model.....
Epoch: 19                               |  Val Loss:3.6213
##################################################################
Epoch: 20, step/total_step: 5/60 8.33%  | Loss:1.7162
Epoch: 20, step/total_step: 10/60 16.67%        | Loss:0.9780
Epoch: 20, step/total_step: 15/60 25.00%        | Loss:0.9737
Epoch: 20, step/total_step: 20/60 33.33%        | Loss:0.4586
Epoch: 20, step/total_step: 25/60 41.67%        | Loss:0.4939
Epoch: 20, step/total_step: 30/60 50.00%        | Loss:0.3612
Epoch: 20, step/total_step: 35/60 58.33%        | Loss:0.5134
Epoch: 20, step/total_step: 40/60 66.67%        | Loss:0.3494
Epoch: 20, step/total_step: 45/60 75.00%        | Loss:0.3154
Epoch: 20, step/total_step: 50/60 83.33%        | Loss:0.2973
Epoch: 20, step/total_step: 55/60 91.67%        | Loss:0.2666
Epoch: 20, step/total_step: 60/60 100.00%       | Loss:0.1795
Epoch: 20                               |  Val Loss:3.7284
##################################################################
Epoch: 21, step/total_step: 5/60 8.33%  | Loss:1.4671
Epoch: 21, step/total_step: 10/60 16.67%        | Loss:0.8468
Epoch: 21, step/total_step: 15/60 25.00%        | Loss:0.8329
Epoch: 21, step/total_step: 20/60 33.33%        | Loss:0.4275
Epoch: 21, step/total_step: 25/60 41.67%        | Loss:0.4353
Epoch: 21, step/total_step: 30/60 50.00%        | Loss:0.3215
Epoch: 21, step/total_step: 35/60 58.33%        | Loss:0.4608
Epoch: 21, step/total_step: 40/60 66.67%        | Loss:0.3122
Epoch: 21, step/total_step: 45/60 75.00%        | Loss:0.2805
Epoch: 21, step/total_step: 50/60 83.33%        | Loss:0.2636
Epoch: 21, step/total_step: 55/60 91.67%        | Loss:0.2423
Epoch: 21, step/total_step: 60/60 100.00%       | Loss:0.1605
Epoch: 21                               |  Val Loss:3.7831
##################################################################
Epoch: 22, step/total_step: 5/60 8.33%  | Loss:1.2835
Epoch: 22, step/total_step: 10/60 16.67%        | Loss:0.7513
Epoch: 22, step/total_step: 15/60 25.00%        | Loss:0.7257
Epoch: 22, step/total_step: 20/60 33.33%        | Loss:0.3794
Epoch: 22, step/total_step: 25/60 41.67%        | Loss:0.3849
Epoch: 22, step/total_step: 30/60 50.00%        | Loss:0.2810
Epoch: 22, step/total_step: 35/60 58.33%        | Loss:0.4031
Epoch: 22, step/total_step: 40/60 66.67%        | Loss:0.2793
Epoch: 22, step/total_step: 45/60 75.00%        | Loss:0.2428
Epoch: 22, step/total_step: 50/60 83.33%        | Loss:0.2341
Epoch: 22, step/total_step: 55/60 91.67%        | Loss:0.2207
Epoch: 22, step/total_step: 60/60 100.00%       | Loss:0.1437
Epoch: 22                               |  Val Loss:3.8525
##################################################################
Epoch: 23, step/total_step: 5/60 8.33%  | Loss:1.1086
Epoch: 23, step/total_step: 10/60 16.67%        | Loss:0.6470
Epoch: 23, step/total_step: 15/60 25.00%        | Loss:0.6462
Epoch: 23, step/total_step: 20/60 33.33%        | Loss:0.3379
Epoch: 23, step/total_step: 25/60 41.67%        | Loss:0.3412
Epoch: 23, step/total_step: 30/60 50.00%        | Loss:0.2590
Epoch: 23, step/total_step: 35/60 58.33%        | Loss:0.3474
Epoch: 23, step/total_step: 40/60 66.67%        | Loss:0.2570
Epoch: 23, step/total_step: 45/60 75.00%        | Loss:0.2188
Epoch: 23, step/total_step: 50/60 83.33%        | Loss:0.2084
Epoch: 23, step/total_step: 55/60 91.67%        | Loss:0.2012
Epoch: 23, step/total_step: 60/60 100.00%       | Loss:0.1290
Epoch: 23                               |  Val Loss:3.8995
##################################################################
Epoch: 24, step/total_step: 5/60 8.33%  | Loss:0.9695
Epoch: 24, step/total_step: 10/60 16.67%        | Loss:0.5627
Epoch: 24, step/total_step: 15/60 25.00%        | Loss:0.5599
Epoch: 24, step/total_step: 20/60 33.33%        | Loss:0.2863
Epoch: 24, step/total_step: 25/60 41.67%        | Loss:0.2927
Epoch: 24, step/total_step: 30/60 50.00%        | Loss:0.2402
Epoch: 24, step/total_step: 35/60 58.33%        | Loss:0.2949
Epoch: 24, step/total_step: 40/60 66.67%        | Loss:0.2221
Epoch: 24, step/total_step: 45/60 75.00%        | Loss:0.1957
Epoch: 24, step/total_step: 50/60 83.33%        | Loss:0.1874
Epoch: 24, step/total_step: 55/60 91.67%        | Loss:0.1844
Epoch: 24, step/total_step: 60/60 100.00%       | Loss:0.1161
Epoch: 24                               |  Val Loss:3.9277
##################################################################
Epoch: 25, step/total_step: 5/60 8.33%  | Loss:0.8567
Epoch: 25, step/total_step: 10/60 16.67%        | Loss:0.4959
Epoch: 25, step/total_step: 15/60 25.00%        | Loss:0.4964
Epoch: 25, step/total_step: 20/60 33.33%        | Loss:0.2571
Epoch: 25, step/total_step: 25/60 41.67%        | Loss:0.2459
Epoch: 25, step/total_step: 30/60 50.00%        | Loss:0.2180
Epoch: 25, step/total_step: 35/60 58.33%        | Loss:0.2583
Epoch: 25, step/total_step: 40/60 66.67%        | Loss:0.1938
Epoch: 25, step/total_step: 45/60 75.00%        | Loss:0.1746
Epoch: 25, step/total_step: 50/60 83.33%        | Loss:0.1684
Epoch: 25, step/total_step: 55/60 91.67%        | Loss:0.1706
Epoch: 25, step/total_step: 60/60 100.00%       | Loss:0.1042
Epoch: 25                               |  Val Loss:3.9897
##################################################################
Epoch: 26, step/total_step: 5/60 8.33%  | Loss:0.7600
Epoch: 26, step/total_step: 10/60 16.67%        | Loss:0.4659
Epoch: 26, step/total_step: 15/60 25.00%        | Loss:0.4341
Epoch: 26, step/total_step: 20/60 33.33%        | Loss:0.2419
Epoch: 26, step/total_step: 25/60 41.67%        | Loss:0.2203
Epoch: 26, step/total_step: 30/60 50.00%        | Loss:0.1811
Epoch: 26, step/total_step: 35/60 58.33%        | Loss:0.2325
Epoch: 26, step/total_step: 40/60 66.67%        | Loss:0.1769
Epoch: 26, step/total_step: 45/60 75.00%        | Loss:0.1553
Epoch: 26, step/total_step: 50/60 83.33%        | Loss:0.1506
Epoch: 26, step/total_step: 55/60 91.67%        | Loss:0.1550
Epoch: 26, step/total_step: 60/60 100.00%       | Loss:0.0941
Epoch: 26                               |  Val Loss:4.0812
##################################################################
Epoch: 27, step/total_step: 5/60 8.33%  | Loss:0.6672
Epoch: 27, step/total_step: 10/60 16.67%        | Loss:0.4185
Epoch: 27, step/total_step: 15/60 25.00%        | Loss:0.3872
Epoch: 27, step/total_step: 20/60 33.33%        | Loss:0.2111
Epoch: 27, step/total_step: 25/60 41.67%        | Loss:0.2103
Epoch: 27, step/total_step: 30/60 50.00%        | Loss:0.1483
Epoch: 27, step/total_step: 35/60 58.33%        | Loss:0.2047
Epoch: 27, step/total_step: 40/60 66.67%        | Loss:0.1696
Epoch: 27, step/total_step: 45/60 75.00%        | Loss:0.1451
Epoch: 27, step/total_step: 50/60 83.33%        | Loss:0.1357
Epoch: 27, step/total_step: 55/60 91.67%        | Loss:0.1406
Epoch: 27, step/total_step: 60/60 100.00%       | Loss:0.0850
Epoch: 27                               |  Val Loss:4.1260
##################################################################
Epoch: 28, step/total_step: 5/60 8.33%  | Loss:0.5870
Epoch: 28, step/total_step: 10/60 16.67%        | Loss:0.3624
Epoch: 28, step/total_step: 15/60 25.00%        | Loss:0.3439
Epoch: 28, step/total_step: 20/60 33.33%        | Loss:0.1780
Epoch: 28, step/total_step: 25/60 41.67%        | Loss:0.1877
Epoch: 28, step/total_step: 30/60 50.00%        | Loss:0.1355
Epoch: 28, step/total_step: 35/60 58.33%        | Loss:0.1759
Epoch: 28, step/total_step: 40/60 66.67%        | Loss:0.1466
Epoch: 28, step/total_step: 45/60 75.00%        | Loss:0.1359
Epoch: 28, step/total_step: 50/60 83.33%        | Loss:0.1253
Epoch: 28, step/total_step: 55/60 91.67%        | Loss:0.1285
Epoch: 28, step/total_step: 60/60 100.00%       | Loss:0.0769
Epoch: 28                               |  Val Loss:4.0971
##################################################################
Epoch: 29, step/total_step: 5/60 8.33%  | Loss:0.5202
Epoch: 29, step/total_step: 10/60 16.67%        | Loss:0.3204
Epoch: 29, step/total_step: 15/60 25.00%        | Loss:0.3013
Epoch: 29, step/total_step: 20/60 33.33%        | Loss:0.1620
Epoch: 29, step/total_step: 25/60 41.67%        | Loss:0.1616
Epoch: 29, step/total_step: 30/60 50.00%        | Loss:0.1239
Epoch: 29, step/total_step: 35/60 58.33%        | Loss:0.1583
Epoch: 29, step/total_step: 40/60 66.67%        | Loss:0.1291
Epoch: 29, step/total_step: 45/60 75.00%        | Loss:0.1185
Epoch: 29, step/total_step: 50/60 83.33%        | Loss:0.1128
Epoch: 29, step/total_step: 55/60 91.67%        | Loss:0.1183
Epoch: 29, step/total_step: 60/60 100.00%       | Loss:0.0697
Epoch: 29                               |  Val Loss:4.1699
##################################################################
Epoch: 30, step/total_step: 5/60 8.33%  | Loss:0.4769
Epoch: 30, step/total_step: 10/60 16.67%        | Loss:0.2969
Epoch: 30, step/total_step: 15/60 25.00%        | Loss:0.2664
Epoch: 30, step/total_step: 20/60 33.33%        | Loss:0.1506
Epoch: 30, step/total_step: 25/60 41.67%        | Loss:0.1453
Epoch: 30, step/total_step: 30/60 50.00%        | Loss:0.1101
Epoch: 30, step/total_step: 35/60 58.33%        | Loss:0.1419
Epoch: 30, step/total_step: 40/60 66.67%        | Loss:0.1160
Epoch: 30, step/total_step: 45/60 75.00%        | Loss:0.1076
Epoch: 30, step/total_step: 50/60 83.33%        | Loss:0.1026
Epoch: 30, step/total_step: 55/60 91.67%        | Loss:0.1085
Epoch: 30, step/total_step: 60/60 100.00%       | Loss:0.0632
Epoch: 30                               |  Val Loss:4.2039
##################################################################
##################################################################
Done Training, total time: 510s.
Evaluating bilstm_crf Model ...
C:\Users\yimen\Desktop\Environments\project\lib\site-packages\torch\nn\modules\rnn.py:525: RuntimeWarning: RNN module weights are not part of single contiguous chunk of memory. This means they need to be compacted at every call, possibly greatly increasing memory usage. To compact weights again call flatten_parameters().
  self.num_layers, self.dropout, self.training, self.bidirectional)
           precision    recall  f1-score   support
    B-LOC     1.0000    0.8333    0.9091         6
   B-CONT     1.0000    1.0000    1.0000        28
   E-NAME     0.9722    0.9375    0.9545       112
    M-PRO     0.8026    0.8971    0.8472        68
   B-NAME     1.0000    0.9464    0.9725       112
  E-TITLE     0.9869    0.9792    0.9831       771
   E-CONT     1.0000    1.0000    1.0000        28
    E-LOC     1.0000    0.8333    0.9091         6
 E-TITLE
     0.0000    0.0000    0.0000         1
    B-ORG     0.9622    0.9675    0.9648       553
        O     0.9521    0.9860    0.9687      4714
   B-RACE     1.0000    0.9286    0.9630        14
    M-ORG     0.9633    0.9577    0.9605      4325
  M-TITLE     0.9548    0.9006    0.9269      1922
    E-ORG     0.9227    0.9060    0.9142       553
   M-CONT     1.0000    1.0000    1.0000        53
    M-EDU     0.9770    0.9497    0.9632       179
    E-EDU     0.9732    0.9732    0.9732       112
   M-NAME     0.9747    0.9390    0.9565        82
       O
     1.0000    1.0000    1.0000       476
    E-PRO     0.9091    0.9091    0.9091        33
  B-TITLE     0.9388    0.9339    0.9364       772
   E-RACE     1.0000    1.0000    1.0000        14
    M-LOC     1.0000    0.8095    0.8947        21
    B-PRO     0.9062    0.8788    0.8923        33
    B-EDU     0.9910    0.9821    0.9865       112
avg/total     0.9585    0.9582    0.9581     15100
##################################################################
Confusion Matrix:
          B-LOC  B-CONT  E-NAME   M-PRO  B-NAME E-TITLE  E-CONT   E-LOC E-TITLE
   B-ORG       O  B-RACE   M-ORG M-TITLE   E-ORG  M-CONT   M-EDU   E-EDU  M-NAME      O
   E-PRO B-TITLE  E-RACE   M-LOC   B-PRO   B-EDU
  B-LOC       5       0       0       0       0       0       0       0       0       1       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0
 B-CONT       0      28       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0
 E-NAME       0       0     105       0       0       0       0       0       0       0       6       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0
  M-PRO       0       0       0      61       0       0       0       0       0       0       2       0       4       0       1       0       0       0       0       0       0       0       0       0       0       0
 B-NAME       0       0       0       0     106       0       0       0       0       0       6       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0
E-TITLE       0       0       2       0       0     755       0       0       0       0      10       0       2       1       0       0       0       1       0       0       0       0       0       0       0       0
 E-CONT       0       0       0       0       0       0      28       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0
  E-LOC       0       0       0       0       0       0       0       5       0       0       1       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0
E-TITLE
       0       0       0       0       0       1       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0
  B-ORG       0       0       0       0       0       0       0       0       0     535      10       0       3       0       0       0       0       0       0       0       0       5       0       0       0       0
      O       0       0       0       0       0       4       0       0       0       6    4648       0      43       2       4       0       0       1       0       0       0       6       0       0       0       0
 B-RACE       0       0       0       0       0       0       0       0       0       0       1      13       0       0       0       0       0       0       0       0       0       0       0       0       0       0
  M-ORG       0       0       0       6       0       1       0       0       0       4     102       0    4142      39      17       0       0       0       0       0       1      11       0       0       2       0
M-TITLE       0       0       0       1       0       3       0       0       0       3      64       0      77    1731      17       0       1       0       2       0       1      21       0       0       0       1
  E-ORG       0       0       0       1       0       1       0       0       0       0      14       0      14      18     501       0       0       0       0       0       0       4       0       0       0       0
 M-CONT       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0      53       0       0       0       0       0       0       0       0       0       0
  M-EDU       0       0       0       4       0       0       0       0       0       0       2       0       0       0       1       0     170       1       0       0       0       0       0       0       1       0
  E-EDU       0       0       0       0       0       0       0       0       0       0       1       0       0       0       0       0       1     109       0       0       1       0       0       0       0       0
 M-NAME       0       0       1       0       0       0       0       0       0       0       2       0       0       0       0       0       0       0      77       0       0       0       0       0       0       0
     O
       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0     476       0       0       0       0       0       0
  E-PRO       0       0       0       1       0       0       0       0       0       0       1       0       0       0       0       0       1       0       0       0      30       0       0       0       0       0
B-TITLE       0       0       0       0       0       0       0       0       0       7      12       0       8      22       2       0       0       0       0       0       0     721       0       0       0       0
 E-RACE       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0      14       0       0       0
  M-LOC       0       0       0       0       0       0       0       0       0       0       0       0       4       0       0       0       0       0       0       0       0       0       0      17       0       0
  B-PRO       0       0       0       2       0       0       0       0       0       0       0       0       2       0       0       0       0       0       0       0       0       0       0       0      29       0
  B-EDU       0       0       0       0       0       0       0       0       0       0       0       0       1       0       0       0       1       0       0       0       0       0       0       0       0     110

(project) C:\Users\yimen\Desktop\comp_551\A4\NER>